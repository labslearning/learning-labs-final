# Generated by Django 5.2 on 2025-12-20 19:04

import django.db.models.deletion
import django.utils.timezone
import tasks.models
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('auth', '0012_alter_user_first_name_max_length'),
        ('contenttypes', '0002_remove_content_type_name'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='ChatRoom',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=100, unique=True, verbose_name='Nombre')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Creaci贸n')),
            ],
            options={
                'verbose_name': 'Sala de Chat',
                'verbose_name_plural': 'Salas de Chat',
            },
        ),
        migrations.CreateModel(
            name='Institucion',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('nombre', models.CharField(max_length=150)),
                ('logo', models.ImageField(blank=True, null=True, upload_to='logos_institucionales/')),
                ('direccion', models.CharField(blank=True, max_length=150, null=True)),
                ('telefono', models.CharField(blank=True, max_length=50, null=True)),
                ('correo', models.EmailField(blank=True, max_length=254, null=True)),
                ('nit', models.CharField(blank=True, max_length=50, null=True)),
                ('ciudad', models.CharField(blank=True, max_length=100, null=True)),
                ('departamento', models.CharField(blank=True, max_length=100, null=True)),
                ('resolucion', models.CharField(blank=True, max_length=200, null=True)),
                ('lema', models.CharField(blank=True, max_length=200, null=True)),
                ('anio_lectivo', models.CharField(default='2025', max_length=10)),
                ('archivo_pei', models.FileField(blank=True, help_text='Carga aqu铆 el Proyecto Educativo Institucional en formato PDF.', null=True, upload_to='documentos_institucionales/', verbose_name='Documento PEI (PDF)')),
            ],
            options={
                'verbose_name': 'Instituci贸n',
                'verbose_name_plural': 'Informaci贸n Institucional',
            },
        ),
        migrations.CreateModel(
            name='Logro',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('nombre', models.CharField(max_length=100)),
                ('slug', models.SlugField(help_text='Identificador 煤nico', unique=True)),
                ('descripcion', models.TextField()),
                ('imagen', models.ImageField(blank=True, null=True, upload_to='gamification/badges/')),
                ('clase_css', models.CharField(choices=[('BRONZE', 'Bronce (B谩sico)'), ('SILVER', 'Plata (Intermedio)'), ('GOLD', 'Oro (Avanzado)'), ('DIAMOND', 'Diamante (Experto)')], default='BRONZE', max_length=20)),
                ('puntos_otorgados', models.IntegerField(default=10)),
                ('es_oculto', models.BooleanField(default=False)),
            ],
            options={
                'verbose_name': 'Definici贸n de Logro',
                'verbose_name_plural': 'Definiciones de Logros',
            },
        ),
        migrations.CreateModel(
            name='PEIResumen',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('version', models.CharField(help_text='Ej: v2025.1 - Actualizaci贸n Manual Convivencia', max_length=50, unique=True)),
                ('fecha_creacion', models.DateTimeField(auto_now_add=True)),
                ('activo', models.BooleanField(default=True, help_text="Solo una versi贸n del PEI es la 'Verdad Absoluta' a la vez.")),
                ('contenido_estructurado', models.JSONField(default=dict, help_text='JSON estructurado con Misi贸n, Visi贸n, Ejes, Evaluaci贸n y Convivencia.')),
                ('comentarios_cambio', models.TextField(blank=True, help_text='Justificaci贸n de los cambios en esta versi贸n (Auditor铆a).')),
            ],
            options={
                'verbose_name': 'Conocimiento PEI (JSON)',
                'verbose_name_plural': 'Versiones del PEI',
                'ordering': ['-fecha_creacion'],
            },
        ),
        migrations.CreateModel(
            name='Perfil',
            fields=[
                ('user', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, primary_key=True, serialize=False, to=settings.AUTH_USER_MODEL)),
                ('rol', models.CharField(choices=[('ESTUDIANTE', 'Estudiante'), ('DOCENTE', 'Docente'), ('ADMINISTRADOR', 'Administrador'), ('DIRECTOR_CURSO', 'Director de Curso'), ('ACUDIENTE', 'Acudiente'), ('PSICOLOGO', 'Psic贸logo'), ('COORD_CONVIVENCIA', 'Coord. Convivencia'), ('COORD_ACADEMICO', 'Coord. Acad茅mico')], default='ESTUDIANTE', max_length=20)),
                ('es_director', models.BooleanField(default=False)),
                ('requiere_cambio_clave', models.BooleanField(default=False)),
                ('foto_perfil', models.ImageField(blank=True, null=True, upload_to='perfiles/avatars/', verbose_name='Foto de Perfil')),
                ('foto_portada', models.ImageField(blank=True, null=True, upload_to='perfiles/covers/', verbose_name='Foto de Portada')),
                ('biografia', models.TextField(blank=True, max_length=500, verbose_name='Sobre m铆')),
                ('hobbies', models.TextField(blank=True, null=True, verbose_name='Mis Hobbies')),
                ('gustos_musicales', models.CharField(blank=True, max_length=255, null=True, verbose_name='M煤sica favorita')),
                ('libros_favoritos', models.TextField(blank=True, null=True, verbose_name='Libros que me gustan')),
                ('materia_favorita', models.CharField(blank=True, max_length=100, null=True, verbose_name='Materia favorita')),
                ('metas_anio', models.TextField(blank=True, null=True, verbose_name='Metas del a帽o lectivo')),
                ('puntos_reputacion', models.IntegerField(default=0, verbose_name='Reputaci贸n Acad茅mica')),
                ('last_seen', models.DateTimeField(blank=True, null=True, verbose_name='ltima vez visto')),
                ('perfil_publico', models.BooleanField(default=True, help_text='Si es falso, solo profesores y compa帽eros de curso pueden verlo.')),
            ],
            options={
                'verbose_name': 'Perfil de Usuario',
                'verbose_name_plural': 'Perfiles de Usuario',
            },
        ),
        migrations.CreateModel(
            name='PeriodoAcademico',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('nombre', models.CharField(help_text='Ej: 2025-1, A帽o Lectivo 2025, Trimestre 2', max_length=100, unique=True)),
                ('fecha_inicio', models.DateField(help_text='Fecha oficial de inicio del periodo acad茅mico')),
                ('fecha_fin', models.DateField(help_text='Fecha oficial de finalizaci贸n del periodo acad茅mico')),
                ('activo', models.BooleanField(default=False, help_text=' CRTICO: Solo un periodo puede estar activo. Al activar este, se desactivan los dem谩s.')),
                ('limite_intentos_profesor', models.IntegerField(default=10, help_text='Intentos de IA profunda (DeepSeek) permitidos por periodo para docentes.')),
                ('limite_intentos_estudiante', models.IntegerField(default=2, help_text='Intentos de IA profunda permitidos por periodo para estudiantes.')),
                ('limite_intentos_acudiente', models.IntegerField(default=1, help_text='Intentos de IA para orientaci贸n familiar por periodo.')),
                ('limite_intentos_staff', models.IntegerField(default=50, help_text='Intentos para Staff (Psicolog铆a/Coord) para an谩lisis institucional.')),
                ('creado_en', models.DateTimeField(auto_now_add=True)),
                ('cerrado_en', models.DateTimeField(blank=True, help_text='Fecha en que el periodo fue cerrado institucionalmente', null=True)),
            ],
            options={
                'verbose_name': 'Periodo Acad茅mico (Governance)',
                'verbose_name_plural': 'Periodos Acad茅micos (Governance)',
                'ordering': ['-fecha_inicio'],
            },
        ),
        migrations.CreateModel(
            name='AIUsageLog',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('fecha', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('rol_usado', models.CharField(choices=[('DOCENTE', 'DOCENTE'), ('ESTUDIANTE', 'ESTUDIANTE'), ('ACUDIENTE', 'ACUDIENTE'), ('STAFF', 'STAFF'), ('ADMINISTRADOR', 'ADMINISTRADOR')], help_text='El rol con el que el usuario firm贸 la petici贸n (Docente, Estudiante, etc).', max_length=50)),
                ('accion', models.CharField(choices=[('mejoras_estudiante', 'mejoras_estudiante'), ('chat_socratico', 'chat_socratico'), ('mejoras_docente', 'mejoras_docente'), ('orientacion_curso', 'orientacion_curso'), ('apoyo_acudiente', 'apoyo_acudiente'), ('staff_academico', 'staff_academico'), ('analisis_convivencia', 'analisis_convivencia'), ('cumplimiento_pei', 'cumplimiento_pei')], help_text='La intenci贸n pedag贸gica (Intents).', max_length=50)),
                ('modelo_utilizado', models.CharField(default='deepseek-chat', max_length=50)),
                ('tokens_entrada', models.IntegerField(default=0, help_text='Contexto + Prompt (Lo que enviamos)')),
                ('tokens_salida', models.IntegerField(default=0, help_text='Respuesta generada (Lo que recibimos)')),
                ('tiempo_ejecucion', models.FloatField(default=0.0, help_text='Segundos que tard贸 la respuesta')),
                ('exitoso', models.BooleanField(default=True)),
                ('error_mensaje', models.TextField(blank=True, help_text='Si fall贸, aqu铆 guardamos el stacktrace o mensaje de error de la API.', null=True)),
                ('metadata_tecnica', models.JSONField(blank=True, default=dict, help_text='Datalles t茅cnicos: pei_version, razon_fallo, intentos_restantes, costo_estimado_usd.')),
                ('usuario', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='ai_logs', to=settings.AUTH_USER_MODEL)),
                ('periodo', models.ForeignKey(help_text='Periodo acad茅mico activo durante la consulta.', null=True, on_delete=django.db.models.deletion.PROTECT, to='tasks.periodoacademico')),
            ],
            options={
                'verbose_name': 'Log de Uso IA',
                'verbose_name_plural': 'Auditor铆a de IA',
                'ordering': ['-fecha'],
            },
        ),
        migrations.CreateModel(
            name='AuditLog',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('accion', models.CharField(choices=[('CREATE', 'Creaci贸n'), ('UPDATE', 'Edici贸n'), ('DELETE', 'Eliminaci贸n'), ('LOGIN', 'Inicio de Sesi贸n'), ('LOGIN_FAIL', 'Fallo de Login'), ('SENSITIVE', 'Acceso Sensible')], max_length=20)),
                ('modelo_afectado', models.CharField(max_length=100)),
                ('objeto_id', models.CharField(blank=True, max_length=100, null=True)),
                ('detalles', models.TextField(blank=True)),
                ('ip_address', models.GenericIPAddressField(blank=True, null=True)),
                ('fecha', models.DateTimeField(auto_now_add=True)),
                ('usuario', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Registro de Auditor铆a',
                'verbose_name_plural': 'Registros de Auditor铆a',
                'ordering': ['-fecha'],
            },
        ),
        migrations.CreateModel(
            name='Curso',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('nombre', models.CharField(max_length=100)),
                ('descripcion', models.TextField(blank=True, verbose_name='Descripci贸n')),
                ('capacidad_maxima', models.IntegerField(default=40, verbose_name='Capacidad M谩xima')),
                ('anio_escolar', models.CharField(default='2025-2026', max_length=9, verbose_name='A帽o Escolar')),
                ('seccion', models.CharField(default='A', max_length=100, verbose_name='Secci贸n')),
                ('grado', models.CharField(choices=[('PREKINDER', 'Prekinder'), ('KINDER', 'Kinder'), ('JARDIN', 'Jard铆n'), ('TRANSICION', 'Transici贸n'), ('1', 'Primer grado'), ('2', 'Segundo grado'), ('3', 'Tercer grado'), ('4', 'Cuarto grado'), ('5', 'Quinto grado'), ('6', 'Sexto grado'), ('7', 'S茅ptimo grado'), ('8', 'Octavo grado'), ('9', 'Noveno grado'), ('10', 'D茅cimo grado'), ('11', 'Und茅cimo grado')], default='6', max_length=20, verbose_name='Grado')),
                ('activo', models.BooleanField(default=True)),
                ('fecha_creacion', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Creaci贸n')),
                ('director', models.ForeignKey(blank=True, limit_choices_to={'perfil__rol__in': ['DOCENTE']}, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='cursos_dirigidos', to=settings.AUTH_USER_MODEL, verbose_name='Director de Curso')),
            ],
            options={
                'verbose_name': 'Curso',
                'verbose_name_plural': 'Cursos',
                'ordering': ['grado', 'seccion'],
                'unique_together': {('grado', 'seccion', 'anio_escolar')},
            },
        ),
        migrations.CreateModel(
            name='Materia',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('nombre', models.CharField(max_length=100, verbose_name='Nombre')),
                ('descripcion', models.TextField(blank=True, verbose_name='Descripci贸n')),
                ('curso', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='materias', to='tasks.curso', verbose_name='Curso')),
            ],
            options={
                'verbose_name': 'Materia',
                'verbose_name_plural': 'Materias',
                'unique_together': {('nombre', 'curso')},
            },
        ),
        migrations.CreateModel(
            name='ActividadSemanal',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('titulo', models.CharField(default='Actividad de la Semana', max_length=200, verbose_name='T铆tulo')),
                ('descripcion', models.TextField(verbose_name='Descripci贸n')),
                ('fecha_inicio', models.DateField(blank=True, null=True, verbose_name='Fecha de Inicio')),
                ('fecha_fin', models.DateField(blank=True, null=True, verbose_name='Fecha de Finalizaci贸n')),
                ('fecha_creacion', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Creaci贸n')),
                ('docente', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL, verbose_name='Docente')),
                ('curso', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='actividades_semanales', to='tasks.curso')),
                ('materia', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='actividades', to='tasks.materia')),
            ],
            options={
                'verbose_name': 'Actividad Semanal',
                'verbose_name_plural': 'Actividades Semanales',
                'ordering': ['-fecha_creacion'],
            },
        ),
        migrations.CreateModel(
            name='MensajeInterno',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('asunto', models.CharField(max_length=200)),
                ('cuerpo', models.TextField()),
                ('leido', models.BooleanField(default=False)),
                ('fecha_envio', models.DateTimeField(auto_now_add=True)),
                ('archivo', models.FileField(blank=True, null=True, upload_to='adjuntos_chat/', verbose_name='Archivo Adjunto')),
                ('destinatario', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='mensajes_recibidos', to=settings.AUTH_USER_MODEL)),
                ('remitente', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='mensajes_enviados', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Mensaje Profesional',
                'ordering': ['-fecha_envio'],
            },
        ),
        migrations.CreateModel(
            name='Notificacion',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('titulo', models.CharField(max_length=100)),
                ('mensaje', models.TextField()),
                ('tipo', models.CharField(choices=[('ASISTENCIA', 'Novedad de Asistencia'), ('OBSERVADOR', 'Nueva Observaci贸n'), ('ACTIVIDAD', 'Nueva Actividad'), ('MENSAJE', 'Nuevo Mensaje'), ('SISTEMA', 'Sistema')], default='SISTEMA', max_length=20)),
                ('leida', models.BooleanField(default=False)),
                ('fecha_creacion', models.DateTimeField(auto_now_add=True)),
                ('link_destino', models.CharField(blank=True, max_length=200, null=True)),
                ('usuario', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='mis_notificaciones', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'ordering': ['-fecha_creacion'],
            },
        ),
        migrations.CreateModel(
            name='Periodo',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('nombre', models.CharField(max_length=50, verbose_name='Nombre')),
                ('fecha_inicio', models.DateField(default=django.utils.timezone.now, verbose_name='Fecha de Inicio')),
                ('fecha_fin', models.DateField(default=django.utils.timezone.now, verbose_name='Fecha de Fin')),
                ('activo', models.BooleanField(default=True, verbose_name='Activo')),
                ('curso', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='periodos', to='tasks.curso', verbose_name='Curso')),
            ],
            options={
                'verbose_name': 'Periodo',
                'verbose_name_plural': 'Periodos',
                'unique_together': {('nombre', 'curso')},
            },
        ),
        migrations.CreateModel(
            name='Observacion',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('tipo', models.CharField(choices=[('CONVIVENCIA', 'Situaci贸n de Convivencia'), ('ACADEMICA', 'Compromiso Acad茅mico'), ('PSICOLOGIA', 'Orientaci贸n Psicol贸gica'), ('FELICITACION', 'Felicitaci贸n / Reconocimiento')], max_length=20)),
                ('descripcion', models.TextField(verbose_name='Descripci贸n de la situaci贸n')),
                ('compromisos_estudiante', models.TextField(blank=True, verbose_name='Compromisos del Estudiante')),
                ('compromisos_familia', models.TextField(blank=True, verbose_name='Compromisos de la Familia/Acudiente')),
                ('fecha_creacion', models.DateTimeField(auto_now_add=True)),
                ('fecha_actualizacion', models.DateTimeField(auto_now=True)),
                ('fecha_limite_edicion', models.DateTimeField(editable=False)),
                ('autor', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='observaciones_creadas', to=settings.AUTH_USER_MODEL)),
                ('estudiante', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='observaciones', to=settings.AUTH_USER_MODEL)),
                ('periodo', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='observaciones', to='tasks.periodo')),
            ],
            options={
                'verbose_name': 'Observaci贸n del Alumno',
                'verbose_name_plural': 'Observaciones',
                'ordering': ['-fecha_creacion'],
            },
        ),
        migrations.CreateModel(
            name='AIDocumento',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('titulo', models.CharField(help_text='Ej: Plan de Mejora - Matem谩ticas', max_length=200)),
                ('tipo', models.CharField(choices=[('reporte_pedagogico', 'Reporte Pedag贸gico Docente'), ('orientacion_estudiante', 'Plan de Mejora Estudiantil'), ('orientacion_acudiente', 'Orientaci贸n Familiar'), ('reporte_convivencia', 'Reporte de Convivencia'), ('reporte_institucional', 'An谩lisis Institucional (PEI)')], max_length=50)),
                ('contenido', models.TextField(help_text='Respuesta oficial de la IA en Markdown.')),
                ('contexto_snapshot', models.JSONField(blank=True, default=dict, help_text='\n        FOTO EXACTA de los datos usados (Notas, Observaciones) al momento de generar.\n        Sirve como evidencia inmutable.\n        ')),
                ('creado_en', models.DateTimeField(auto_now_add=True)),
                ('es_publico', models.BooleanField(default=True, help_text='Si es True, acudientes o directores pueden verlo.')),
                ('usuario', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='documentos_ia', to=settings.AUTH_USER_MODEL, verbose_name='Propietario del Documento')),
                ('log_origen', models.OneToOneField(blank=True, help_text='Enlace al log t茅cnico que gener贸 este documento.', null=True, on_delete=django.db.models.deletion.SET_NULL, to='tasks.aiusagelog')),
                ('pei_version', models.ForeignKey(help_text='Bajo qu茅 versi贸n del PEI se gener贸 este documento.', null=True, on_delete=django.db.models.deletion.SET_NULL, to='tasks.peiresumen')),
                ('periodo', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, to='tasks.periodoacademico', verbose_name='Periodo Acad茅mico')),
            ],
            options={
                'verbose_name': 'Documento IA Oficial',
                'verbose_name_plural': 'Documentos IA Oficiales',
                'ordering': ['-creado_en'],
            },
        ),
        migrations.CreateModel(
            name='Post',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('contenido', models.TextField(verbose_name='驴Qu茅 est谩s pensando?')),
                ('tipo', models.CharField(choices=[('PUBLICACION', 'Publicaci贸n General'), ('ANUNCIO', 'Anuncio Oficial'), ('EVENTO', 'Evento')], default='PUBLICACION', max_length=20)),
                ('imagen', models.ImageField(blank=True, null=True, upload_to='social_feed/images/')),
                ('archivo', models.FileField(blank=True, null=True, upload_to='social_feed/files/')),
                ('creado_en', models.DateTimeField(auto_now_add=True)),
                ('actualizado_en', models.DateTimeField(auto_now=True)),
                ('es_destacado', models.BooleanField(default=False)),
                ('autor', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='posts', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Publicaci贸n Social',
                'verbose_name_plural': 'Publicaciones Sociales',
                'ordering': ['-es_destacado', '-creado_en'],
            },
        ),
        migrations.CreateModel(
            name='Comment',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('contenido', models.TextField()),
                ('creado_en', models.DateTimeField(auto_now_add=True)),
                ('autor', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL)),
                ('padre', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='respuestas', to='tasks.comment')),
                ('post', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='comentarios', to='tasks.post')),
            ],
            options={
                'ordering': ['creado_en'],
            },
        ),
        migrations.CreateModel(
            name='Question',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('title', models.CharField(max_length=200, verbose_name='T铆tulo')),
                ('content', models.TextField(verbose_name='Contenido')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Creaci贸n')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL, verbose_name='Usuario')),
            ],
            options={
                'verbose_name': 'Pregunta',
                'verbose_name_plural': 'Preguntas',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='Answer',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('content', models.TextField(verbose_name='Contenido')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Creaci贸n')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL, verbose_name='Usuario')),
                ('question', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='answers', to='tasks.question')),
            ],
            options={
                'verbose_name': 'Respuesta',
                'verbose_name_plural': 'Respuestas',
                'ordering': ['created_at'],
            },
        ),
        migrations.CreateModel(
            name='Reaction',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('tipo', models.CharField(choices=[('LIKE', ' Me gusta'), ('LOVE', 'わ Me encanta'), ('WOW', ' Me asombra'), ('SAD', ' Me entristece'), ('ANGRY', ' Me enoja')], default='LIKE', max_length=10)),
                ('object_id', models.PositiveIntegerField()),
                ('creado_en', models.DateTimeField(auto_now_add=True)),
                ('content_type', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='contenttypes.contenttype')),
                ('usuario', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL)),
            ],
        ),
        migrations.CreateModel(
            name='Report',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('razon', models.CharField(choices=[('BULLYING', 'Acoso o Intimidaci贸n'), ('HATE', 'Lenguaje de Odio'), ('SPAM', 'Spam o Contenido Basura'), ('VIOLENCE', 'Violencia o Amenazas'), ('SEXUAL', 'Contenido Sexual'), ('OTHER', 'Otro motivo')], max_length=20)),
                ('descripcion', models.TextField(blank=True, verbose_name='Detalles adicionales')),
                ('object_id', models.PositiveIntegerField()),
                ('estado', models.CharField(choices=[('PENDING', 'Pendiente de Revisi贸n'), ('RESOLVED', 'Resuelto / Tomada Acci贸n'), ('DISMISSED', 'Descartado / Falso Reporte')], default='PENDING', max_length=20)),
                ('resolucion', models.TextField(blank=True, help_text='Nota del moderador')),
                ('fecha_creacion', models.DateTimeField(auto_now_add=True)),
                ('fecha_resolucion', models.DateTimeField(blank=True, null=True)),
                ('content_type', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='contenttypes.contenttype')),
                ('denunciante', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='reportes_realizados', to=settings.AUTH_USER_MODEL)),
                ('resuelto_por', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='reportes_resueltos', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Reporte de Moderaci贸n',
                'verbose_name_plural': 'Reportes de Moderaci贸n',
                'ordering': ['-fecha_creacion'],
            },
        ),
        migrations.CreateModel(
            name='SecurityLog',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('contenido_intentado', models.TextField()),
                ('razon_bloqueo', models.CharField(max_length=255)),
                ('fecha', models.DateTimeField(auto_now_add=True)),
                ('usuario', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='alertas_seguridad', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Reporte de Seguridad',
                'verbose_name_plural': 'Reportes de Seguridad',
                'ordering': ['-fecha'],
            },
        ),
        migrations.CreateModel(
            name='SocialGroup',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=100, verbose_name='Nombre del Grupo')),
                ('slug', models.SlugField(blank=True, null=True, unique=True)),
                ('description', models.TextField(blank=True, verbose_name='Descripci贸n')),
                ('image', models.ImageField(blank=True, null=True, upload_to='groups/covers/', verbose_name='Imagen de Portada')),
                ('tipo_privacidad', models.CharField(choices=[('PUBLICO', 'P煤blico (Cualquiera puede unirse)'), ('PRIVADO', 'Privado (Requiere aprobaci贸n)')], default='PUBLICO', max_length=10)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('admins', models.ManyToManyField(blank=True, related_name='admin_groups', to=settings.AUTH_USER_MODEL, verbose_name='Administradores')),
                ('creator', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='created_groups', to=settings.AUTH_USER_MODEL, verbose_name='Creador')),
                ('members', models.ManyToManyField(blank=True, related_name='social_groups', to=settings.AUTH_USER_MODEL, verbose_name='Miembros')),
            ],
            options={
                'verbose_name': 'Grupo Social',
                'verbose_name_plural': 'Grupos Sociales',
                'ordering': ['-created_at'],
            },
        ),
        migrations.AddField(
            model_name='post',
            name='grupo',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='posts', to='tasks.socialgroup'),
        ),
        migrations.CreateModel(
            name='GroupMember',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('rol', models.CharField(choices=[('ADMIN', 'Administrador'), ('MODERATOR', 'Moderador'), ('MEMBER', 'Miembro')], default='MEMBER', max_length=10)),
                ('unido_en', models.DateTimeField(auto_now_add=True)),
                ('usuario', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL)),
                ('grupo', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='tasks.socialgroup')),
            ],
            options={
                'verbose_name': 'Miembro de Grupo',
                'verbose_name_plural': 'Miembros de Grupo',
            },
        ),
        migrations.CreateModel(
            name='UserLogro',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('fecha_obtenido', models.DateTimeField(auto_now_add=True)),
                ('es_destacado', models.BooleanField(default=False)),
                ('logro', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='tasks.logro')),
                ('usuario', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='logros_obtenidos', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Logro de Usuario',
                'verbose_name_plural': 'Logros de Usuarios',
                'ordering': ['-fecha_obtenido'],
            },
        ),
        migrations.CreateModel(
            name='Acudiente',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('creado_en', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Creaci贸n')),
                ('acudiente', models.ForeignKey(limit_choices_to={'perfil__rol': 'ACUDIENTE'}, on_delete=django.db.models.deletion.CASCADE, related_name='estudiantes_a_cargo', to=settings.AUTH_USER_MODEL, verbose_name='Usuario Acudiente')),
                ('estudiante', models.ForeignKey(limit_choices_to={'perfil__rol': 'ESTUDIANTE'}, on_delete=django.db.models.deletion.CASCADE, related_name='acudientes_asignados', to=settings.AUTH_USER_MODEL, verbose_name='Usuario Estudiante')),
            ],
            options={
                'verbose_name': 'V铆nculo Acudiente-Estudiante',
                'verbose_name_plural': 'V铆nculos Acudiente-Estudiante',
                'unique_together': {('acudiente', 'estudiante')},
            },
        ),
        migrations.CreateModel(
            name='BoletinArchivado',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('nombre_estudiante', models.CharField(db_index=True, help_text='Nombre completo del estudiante al momento del retiro.', max_length=255)),
                ('username_estudiante', models.CharField(db_index=True, help_text='Username (documento) del estudiante para referencia.', max_length=150)),
                ('grado_archivado', models.CharField(choices=[('PREKINDER', 'Prekinder'), ('KINDER', 'Kinder'), ('JARDIN', 'Jard铆n'), ('TRANSICION', 'Transici贸n'), ('1', 'Primer grado'), ('2', 'Segundo grado'), ('3', 'Tercer grado'), ('4', 'Cuarto grado'), ('5', 'Quinto grado'), ('6', 'Sexto grado'), ('7', 'S茅ptimo grado'), ('8', 'Octavo grado'), ('9', 'Noveno grado'), ('10', 'D茅cimo grado'), ('11', 'Und茅cimo grado')], db_index=True, help_text='El grado que cursaba el estudiante.', max_length=20)),
                ('seccion_archivada', models.CharField(help_text='La secci贸n que cursaba.', max_length=100)),
                ('anio_lectivo_archivado', models.CharField(db_index=True, help_text='El a帽o escolar de este bolet铆n.', max_length=9)),
                ('fecha_eliminado', models.DateTimeField(auto_now_add=True, help_text='Fecha y hora en que se gener贸 este archivo.')),
                ('archivo_pdf', models.FileField(help_text='El archivo PDF del bolet铆n.', upload_to=tasks.models.ruta_archivo_boletin)),
                ('eliminado_por', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='boletines_archivados_por_mi', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Bolet铆n Archivado (Exalumno)',
                'verbose_name_plural': 'Boletines Archivados (Exalumnos)',
                'ordering': ['-anio_lectivo_archivado', 'grado_archivado', 'nombre_estudiante'],
                'unique_together': {('username_estudiante', 'anio_lectivo_archivado')},
            },
        ),
        migrations.CreateModel(
            name='ActiveUser',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('last_activity', models.DateTimeField(auto_now=True, verbose_name='ltima Actividad')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL, verbose_name='Usuario')),
                ('room', models.ForeignKey(null=True, on_delete=django.db.models.deletion.CASCADE, to='tasks.chatroom', verbose_name='Sala de Chat')),
            ],
            options={
                'verbose_name': 'Usuario Activo',
                'verbose_name_plural': 'Usuarios Activos',
                'unique_together': {('user', 'room')},
            },
        ),
        migrations.CreateModel(
            name='Follow',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('creado_en', models.DateTimeField(auto_now_add=True)),
                ('follower', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='siguiendo', to=settings.AUTH_USER_MODEL)),
                ('following', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='seguidores', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Seguimiento',
                'verbose_name_plural': 'Seguimientos',
                'ordering': ['-creado_en'],
                'unique_together': {('follower', 'following')},
            },
        ),
        migrations.CreateModel(
            name='Asistencia',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('fecha', models.DateField(default=django.utils.timezone.now)),
                ('estado', models.CharField(choices=[('ASISTIO', 'Asisti贸'), ('FALLA', 'Falla Injustificada'), ('EXCUSA', 'Falla Excusada'), ('TARDE', 'Llegada Tard铆a')], default='ASISTIO', max_length=15)),
                ('observacion', models.CharField(blank=True, max_length=200, null=True)),
                ('estudiante', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='asistencias', to=settings.AUTH_USER_MODEL)),
                ('registrado_por', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='asistencias_tomadas', to=settings.AUTH_USER_MODEL)),
                ('curso', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='tasks.curso')),
                ('materia', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='tasks.materia')),
            ],
            options={
                'verbose_name': 'Registro de Asistencia',
                'ordering': ['-fecha'],
                'unique_together': {('estudiante', 'materia', 'fecha')},
            },
        ),
        migrations.CreateModel(
            name='AsignacionMateria',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('periodo_academico', models.CharField(default='2025-1', max_length=20, verbose_name='Periodo Acad茅mico')),
                ('activo', models.BooleanField(default=True)),
                ('docente', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='materias_asignadas', to=settings.AUTH_USER_MODEL)),
                ('curso', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='asignaciones_materias', to='tasks.curso')),
                ('materia', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='asignaciones', to='tasks.materia')),
            ],
            options={
                'verbose_name': 'Asignaci贸n de Materia',
                'verbose_name_plural': 'Asignaciones de Materias',
                'unique_together': {('materia', 'curso', 'docente')},
            },
        ),
        migrations.CreateModel(
            name='Matricula',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('anio_escolar', models.CharField(default='2025-2026', max_length=9, verbose_name='A帽o Escolar')),
                ('fecha_matricula', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Matr铆cula')),
                ('activo', models.BooleanField(default=True)),
                ('puede_generar_boletin', models.BooleanField(default=True, help_text='Si est谩 desactivado, el acudiente no podr谩 generar bolet铆n desde su panel.', verbose_name='Acudiente puede generar bolet铆n')),
                ('puede_ver_observador', models.BooleanField(default=True, help_text='Si est谩 desactivado, el acudiente no podr谩 descargar el observador.', verbose_name='Acudiente puede ver Observador')),
                ('curso', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='matriculados', to='tasks.curso')),
                ('estudiante', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='matriculas', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Matr铆cula',
                'verbose_name_plural': 'Matr铆culas',
                'unique_together': {('estudiante', 'anio_escolar')},
            },
        ),
        migrations.CreateModel(
            name='Nota',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('valor', models.DecimalField(decimal_places=2, max_digits=4, verbose_name='Valor')),
                ('descripcion', models.CharField(blank=True, max_length=100, verbose_name='Descripci贸n')),
                ('numero_nota', models.IntegerField(default=1, verbose_name='N煤mero de Nota')),
                ('fecha_registro', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Registro')),
                ('estudiante', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='notas', to=settings.AUTH_USER_MODEL)),
                ('materia', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='notas', to='tasks.materia', verbose_name='Materia')),
                ('registrado_por', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='notas_registradas', to=settings.AUTH_USER_MODEL)),
                ('periodo', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='notas', to='tasks.periodo', verbose_name='Periodo')),
            ],
            options={
                'verbose_name': 'Nota',
                'verbose_name_plural': 'Notas',
                'unique_together': {('estudiante', 'materia', 'periodo', 'numero_nota')},
            },
        ),
        migrations.CreateModel(
            name='LogroPeriodo',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('descripcion', models.TextField(verbose_name='Descripci贸n del Logro')),
                ('fecha_creacion', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Creaci贸n')),
                ('curso', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='logros_periodo', to='tasks.curso', verbose_name='Curso')),
                ('docente', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='logros_registrados', to=settings.AUTH_USER_MODEL, verbose_name='Docente')),
                ('materia', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='logros_materia', to='tasks.materia', verbose_name='Materia')),
                ('periodo', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='logros', to='tasks.periodo', verbose_name='Periodo')),
            ],
            options={
                'verbose_name': 'Logro del Periodo',
                'verbose_name_plural': 'Logros de los Periodos',
                'ordering': ['periodo', '-fecha_creacion'],
                'unique_together': {('curso', 'periodo', 'docente', 'materia')},
            },
        ),
        migrations.CreateModel(
            name='Convivencia',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('valor', models.DecimalField(decimal_places=2, help_text='Valor de la nota de 0.0 a 5.0', max_digits=3)),
                ('comentario', models.TextField(blank=True, help_text='Comentario opcional del director de curso', null=True)),
                ('fecha_registro', models.DateTimeField(auto_now_add=True)),
                ('estudiante', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='convivencias', to=settings.AUTH_USER_MODEL)),
                ('registrado_por', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='convivencias_registradas', to=settings.AUTH_USER_MODEL)),
                ('curso', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='convivencias_curso', to='tasks.curso')),
                ('periodo', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='convivencias_periodo', to='tasks.periodo')),
            ],
            options={
                'verbose_name': 'Nota de Convivencia',
                'verbose_name_plural': 'Notas de Convivencia',
                'ordering': ['-periodo', 'estudiante'],
                'unique_together': {('estudiante', 'curso', 'periodo')},
            },
        ),
        migrations.CreateModel(
            name='ComentarioDocente',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('comentario', models.TextField(verbose_name='Comentario')),
                ('fecha_creacion', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Creaci贸n')),
                ('docente', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='comentarios_escritos', to=settings.AUTH_USER_MODEL)),
                ('estudiante', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='comentarios_recibidos', to=settings.AUTH_USER_MODEL)),
                ('materia', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='comentarios', to='tasks.materia')),
                ('periodo', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='tasks.periodo')),
            ],
            options={
                'verbose_name': 'Comentario del Docente',
                'verbose_name_plural': 'Comentarios de los Docentes',
                'ordering': ['-fecha_creacion'],
                'unique_together': {('docente', 'estudiante', 'materia', 'periodo')},
            },
        ),
        migrations.AddIndex(
            model_name='aiusagelog',
            index=models.Index(fields=['usuario', 'periodo'], name='tasks_aiusa_usuario_00c5b6_idx'),
        ),
        migrations.AddIndex(
            model_name='aiusagelog',
            index=models.Index(fields=['rol_usado', 'fecha'], name='tasks_aiusa_rol_usa_4fd858_idx'),
        ),
        migrations.AddIndex(
            model_name='aidocumento',
            index=models.Index(fields=['usuario', 'tipo', 'periodo'], name='tasks_aidoc_usuario_a70ccc_idx'),
        ),
        migrations.AddIndex(
            model_name='reaction',
            index=models.Index(fields=['content_type', 'object_id'], name='tasks_react_content_dddf30_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='reaction',
            unique_together={('usuario', 'content_type', 'object_id')},
        ),
        migrations.AlterUniqueTogether(
            name='groupmember',
            unique_together={('grupo', 'usuario')},
        ),
        migrations.AlterUniqueTogether(
            name='userlogro',
            unique_together={('usuario', 'logro')},
        ),
    ]
